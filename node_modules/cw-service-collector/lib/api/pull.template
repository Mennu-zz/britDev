
var Collector = require('% collectorDir %/api')(dataAcceptor)

function dataAcceptor(err, data) {

  var collectorName = __dirname.split('/').slice(-1)[0]
  var message

  if (err) {
    //console.log(data)
    message = {
      code: 1,
      body: err
    }
    process.send(message)
  }
  else {

    if (acceptData) {

      var msg = {
        origin: {
          type: 'collector',
          name: collectorName
        },
        body: data,
        time: Date.now()
      }

      acceptData(msg).then(

        function (resolved) {
          //console.log(resolved)
          message = {
            code: 0,
            body: resolved
          }
          process.send(message)
        },

        function (err) {
          //console.log(err)
          message = {
            code: 1,
            body: err
          }
          process.send(message)
        }
      )
    }
    else {
      throw new Error('acceptData not defined')
    }

  }

}

/************* developer code after this line **************/
